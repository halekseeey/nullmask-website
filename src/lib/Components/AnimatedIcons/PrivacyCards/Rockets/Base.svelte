<script>
	import { gsap } from 'gsap'
	import { onMount } from 'svelte'

	export let animationDuration = 3 // animation duration in seconds
	export let isAnimating = false // animation trigger from parent

	const positionData = {
		from: { x: 96, y: 20 },
		to: { x: 96, y: 10 }
	}

	let svgRef
	let animations = []

	function startAnimations() {
		// Clear existing animations
		animations.forEach((anim) => anim.kill())
		animations = []

		// Animate SVG position
		if (svgRef) {
			const anim = gsap.to(svgRef, {
				duration: animationDuration,
				ease: 'power2.inOut',
				attr: {
					x: positionData.to.x,
					y: positionData.to.y
				}
			})
			animations.push(anim)
		}
	}

	function stopAnimations() {
		// Stop all animations and animate back to initial state
		animations.forEach((anim) => anim.kill())
		animations = []

		// Animate SVG position back
		if (svgRef) {
			const anim = gsap.to(svgRef, {
				duration: animationDuration,
				ease: 'power2.inOut',
				attr: {
					x: positionData.from.x,
					y: positionData.from.y
				}
			})
			animations.push(anim)
		}
	}

	// Watch for animation state changes
	$: if (isAnimating) {
		startAnimations()
	} else {
		stopAnimations()
	}
	onMount(() => {
		// Set initial SVG position
		if (svgRef) {
			gsap.set(svgRef, {
				attr: {
					x: positionData.from.x,
					y: positionData.from.y
				}
			})
		}
	})
</script>

<svg
	width="66"
	height="156"
	viewBox="0 0 66 156"
	fill="none"
	xmlns="http://www.w3.org/2000/svg"
	bind:this={svgRef}
>
	<path
		d="M49.9912 95.0764L65.2505 103.194V92.9055C65.2505 91.4582 64.9831 90.1998 64.4482 89.193L57.8568 76.6552C56.441 73.9651 53.3734 73.4775 49.9912 75.4281V95.0607V95.0764Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M15.5093 95.0792L0.25 103.212V92.9241C0.25 91.4768 0.517431 90.2183 1.05229 89.2115L7.64367 76.6737C9.05948 73.9837 12.1271 73.496 15.5093 75.4467V95.0792Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M36.1009 128.694C36.1009 135.065 34.6064 155.279 32.7502 155.279C30.8939 155.279 29.3994 135.065 29.3994 128.694C29.3994 123.077 30.8939 121.725 32.7502 121.725C34.6064 121.725 36.1009 123.077 36.1009 128.694Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M40.0053 117.792H25.4854V119.837C25.4854 119.837 25.4854 119.869 25.4854 119.9C25.4854 122.228 28.7417 124.132 32.7532 124.132C36.7646 124.132 40.021 122.244 40.021 119.9C40.021 119.884 40.021 119.869 40.021 119.837V117.792H40.0053Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M50.0887 99.627H15.4014V109.931C15.4014 109.931 15.4014 110.025 15.4014 110.072C15.4014 115.657 23.1726 120.172 32.7529 120.172C42.3332 120.172 50.1044 115.657 50.1044 110.072C50.1044 110.025 50.1044 109.978 50.1044 109.931V99.627H50.0887Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M50.0887 99.9834H15.4014V108.195C15.4014 108.195 15.4014 108.274 15.4014 108.305C15.4014 112.757 23.1726 116.36 32.7529 116.36C42.3332 116.36 50.1044 112.757 50.1044 108.305C50.1044 108.274 50.1044 108.227 50.1044 108.195V99.9834H50.0887Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M59.8738 65.5188C61.6357 50.8101 58.222 35.8655 49.8216 23.6738C49.4755 23.1546 49.1137 22.6512 48.7361 22.1478L32.7532 0.25L16.7703 22.1478C16.4085 22.6512 16.0466 23.1546 15.6848 23.6738C7.26863 35.8655 3.87069 50.8101 5.63259 65.5188L9.70697 99.6555C9.70697 99.6555 9.70697 99.7814 9.70697 99.8443C9.70697 107.254 20.0266 113.263 32.7532 113.263C45.4797 113.263 55.7994 107.254 55.7994 99.8443C55.7994 99.7814 55.7994 99.7184 55.7994 99.6555L59.8738 65.5188Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M48.7352 22.1478L32.7523 0.25L16.7694 22.1478C16.675 22.2737 16.5963 22.3995 16.502 22.5254C19.2706 26.1436 25.5002 28.6763 32.7523 28.6763C40.0044 28.6763 46.2339 26.1436 49.0026 22.5254C48.9082 22.3995 48.8296 22.2737 48.7352 22.1478Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		opacity="0.3"
		d="M48.7352 22.1478L32.7523 0.25L16.7694 22.1478C16.675 22.2737 16.5963 22.3995 16.502 22.5254C19.2706 26.1436 25.5002 28.6763 32.7523 28.6763C40.0044 28.6763 46.2339 26.1436 49.0026 22.5254C48.9082 22.3995 48.8296 22.2737 48.7352 22.1478Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M59.8744 65.5031L55.8001 99.6555C55.8001 99.6555 55.8001 99.7814 55.8001 99.8443C55.8001 107.254 45.4804 113.247 32.7538 113.247C20.9869 113.247 11.2965 108.119 9.91211 101.496C14.1281 104.312 20.3262 106.09 27.2322 106.09C39.9587 106.09 50.2784 100.08 50.2784 92.6708C50.2784 92.6079 50.2627 92.545 50.2627 92.4821H50.2784L54.3528 58.3454C56.1147 43.6367 52.7167 28.692 44.3005 16.5003C43.9544 15.9812 43.5926 15.4778 43.2151 14.9744L32.6122 0.438775L32.7538 0.25L48.7367 22.1478C49.1143 22.6512 49.4761 23.1546 49.8222 23.6738C58.2227 35.8497 61.6363 50.8101 59.8744 65.5031Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M54.351 58.347L50.2766 92.4837H50.2609C50.2609 92.4837 50.2766 92.6096 50.2766 92.6725C50.2766 100.082 39.9569 106.091 27.2304 106.091C20.3244 106.091 14.1263 104.314 9.91033 101.498C9.78448 100.963 9.72156 100.412 9.72156 99.8459V99.6572L5.63144 65.5047C3.86955 50.8118 7.28322 35.8514 15.6837 23.6754C16.0455 23.1563 16.4073 22.6529 16.7691 22.1495L32.6105 0.44043L43.2133 14.9761C43.5909 15.4795 43.9527 15.9829 44.2988 16.502C52.715 28.6937 56.1129 43.6383 54.351 58.347Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M54.351 58.347L50.2766 92.4837H50.2609C50.2609 92.4837 50.2766 92.6096 50.2766 92.6725C50.2766 100.082 39.9569 106.091 27.2304 106.091C20.3244 106.091 14.1263 104.314 9.91033 101.498C9.78448 100.963 9.72156 100.412 9.72156 99.8459V99.6572L5.63144 65.5047C3.86955 50.8118 7.28322 35.8514 15.6837 23.6754C16.0455 23.1563 16.4073 22.6529 16.7691 22.1495L32.6105 0.44043L43.2133 14.9761C43.5909 15.4795 43.9527 15.9829 44.2988 16.502C52.715 28.6937 56.1129 43.6383 54.351 58.347Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M17.5566 21.4873C23.3248 24.6335 38.7938 25.4201 46.6594 21.4873"
		stroke="#202221"
		stroke-width="0.5"
	/>
	<path
		d="M29.2608 74.5775C29.2608 77.7552 28.1596 80.0205 26.382 81.1059C26.3348 81.1374 24.6673 82.1914 24.6044 82.2228C22.7481 83.2611 23.9279 80.9014 21.112 79.2811C15.4331 76.009 10.8238 68.0647 10.8238 61.5363C10.8238 58.3114 7.85063 58.2799 9.67545 57.2102C9.72264 57.1787 11.752 56.0618 11.7992 56.0461C13.6554 55.0393 16.1882 55.2281 18.9726 56.8327C24.6516 60.1048 29.2608 68.0647 29.2608 74.5775Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M27.2327 75.7919C27.2327 82.3046 22.6234 84.9317 16.9445 81.6596C11.2655 78.3718 6.65625 70.4433 6.65625 63.9148C6.65625 57.3864 11.2655 54.775 16.9445 58.0471C22.6234 61.3349 27.2327 69.2634 27.2327 75.7919Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M25.2983 74.6745C25.2983 79.9602 21.5543 82.0996 16.9451 79.4411C12.3358 76.7825 8.5918 70.3327 8.5918 65.0313C8.5918 59.7299 12.3358 57.6062 16.9451 60.2647C21.5543 62.9233 25.2983 69.3731 25.2983 74.6745Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M18.5811 78.7473C13.9719 76.0887 10.2278 69.6389 10.2278 64.3375C10.2278 61.8991 11.0301 60.1372 12.3358 59.1934C10.0863 59.6024 8.5918 61.6789 8.5918 65.0296C8.5918 70.3153 12.3358 76.7808 16.9451 79.4394C19.4306 80.871 21.6644 80.9182 23.1904 79.817C21.8689 80.0529 20.2801 79.7226 18.5811 78.7473Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M15.6669 109.19L3.52243 132.441L1.06836 130.993V121.146C1.06836 119.761 1.33579 118.251 1.83919 116.709L8.1474 97.4387C9.50029 93.2856 12.442 89.4472 15.6669 87.5752L18.0266 89.0067L15.6669 109.206V109.19Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M18.122 110.64L3.52344 132.444V122.596C3.52344 121.211 3.79087 119.701 4.29427 118.16L10.6025 98.8889C11.9554 94.7358 14.8971 90.8974 18.122 89.0254V110.64Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M49.8196 109.19L61.9641 132.441L64.4182 130.993V121.146C64.4182 119.761 64.1508 118.251 63.6474 116.709L57.3392 97.4387C55.9863 93.2856 53.0445 89.4472 49.8196 87.5752L47.46 89.0067L49.8196 109.206V109.19Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M47.3643 110.64L61.9628 132.444V122.596C61.9628 121.211 61.6954 119.701 61.192 118.16L54.8838 98.8889C53.5309 94.7358 50.5892 90.8974 47.3643 89.0254V110.64Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
</svg>
