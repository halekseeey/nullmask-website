<script>
	import { gsap } from 'gsap'
	import { onMount } from 'svelte'

	export let animationDuration = 3 // animation duration in seconds
	export let isAnimating = false // animation trigger from parent

	export let positionData = {
		from: { x: 45, y: 20 },
		to: { x: 45, y: 10 }
	}

	let svgRef
	let animations = []

	function startAnimations() {
		// Clear existing animations
		animations.forEach((anim) => anim.kill())
		animations = []

		// Animate SVG position
		if (svgRef) {
			const anim = gsap.to(svgRef, {
				duration: animationDuration,
				ease: 'power2.inOut',
				attr: {
					x: positionData.to.x,
					y: positionData.to.y
				}
			})
			animations.push(anim)
		}
	}

	function stopAnimations() {
		// Stop all animations and animate back to initial state
		animations.forEach((anim) => anim.kill())
		animations = []

		// Animate SVG position back
		if (svgRef) {
			const anim = gsap.to(svgRef, {
				duration: animationDuration,
				ease: 'power2.inOut',
				attr: {
					x: positionData.from.x,
					y: positionData.from.y
				}
			})
			animations.push(anim)
		}
	}

	// Watch for animation state changes
	$: if (isAnimating) {
		startAnimations()
	} else {
		stopAnimations()
	}
	onMount(() => {
		// Set initial SVG position
		if (svgRef) {
			gsap.set(svgRef, {
				attr: {
					x: positionData.from.x,
					y: positionData.from.y
				}
			})
		}
	})
</script>

<svg
	width="22"
	height="51"
	viewBox="0 0 22 51"
	fill="none"
	xmlns="http://www.w3.org/2000/svg"
	bind:this={svgRef}
>
	<path
		d="M16.3203 30.8854L21.2503 33.5079V30.184C21.2503 29.7165 21.1639 29.3099 20.9911 28.9846L18.8615 24.9339C18.4041 24.0648 17.413 23.9072 16.3203 24.5375V30.8803V30.8854Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M5.17996 30.8862L0.25 33.5138V30.1899C0.25 29.7223 0.336401 29.3157 0.509204 28.9904L2.63874 24.9397C3.09616 24.0707 4.08723 23.9131 5.17996 24.5433V30.8862Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M11.8321 41.7466C11.8321 43.805 11.3493 50.3359 10.7495 50.3359C10.1498 50.3359 9.66699 43.805 9.66699 41.7466C9.66699 39.9322 10.1498 39.4951 10.7495 39.4951C11.3493 39.4951 11.8321 39.9322 11.8321 41.7466Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M13.0934 38.2256H8.40234V38.8863C8.40234 38.8863 8.40234 38.8965 8.40234 38.9066C8.40234 39.6588 9.45441 40.2738 10.7504 40.2738C12.0464 40.2738 13.0985 39.6639 13.0985 38.9066C13.0985 38.9015 13.0985 38.8965 13.0985 38.8863V38.2256H13.0934Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M16.3513 32.3574H5.14453V35.6864C5.14453 35.6864 5.14453 35.7169 5.14453 35.7322C5.14453 37.5364 7.65525 38.9951 10.7505 38.9951C13.8456 38.9951 16.3564 37.5364 16.3564 35.7322C16.3564 35.7169 16.3564 35.7017 16.3564 35.6864V32.3574H16.3513Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M16.3513 32.4717H5.14453V35.1247C5.14453 35.1247 5.14453 35.1501 5.14453 35.1603C5.14453 36.5986 7.65525 37.7625 10.7505 37.7625C13.8456 37.7625 16.3564 36.5986 16.3564 35.1603C16.3564 35.1501 16.3564 35.1349 16.3564 35.1247V32.4717H16.3513Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M19.512 21.337C20.0813 16.5849 18.9784 11.7566 16.2643 7.81774C16.1525 7.65002 16.0356 7.48738 15.9137 7.32474L10.7499 0.25L5.58616 7.32474C5.46927 7.48738 5.35237 7.65002 5.23548 7.81774C2.51638 11.7566 1.41857 16.5849 1.9878 21.337L3.30415 32.3659C3.30415 32.3659 3.30415 32.4065 3.30415 32.4269C3.30415 34.8207 6.63823 36.7622 10.7499 36.7622C14.8616 36.7622 18.1957 34.8207 18.1957 32.4269C18.1957 32.4065 18.1957 32.3862 18.1957 32.3659L19.512 21.337Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M15.9139 7.32474L10.7501 0.25L5.5864 7.32474C5.55591 7.3654 5.53049 7.40606 5.5 7.44672C6.39451 8.61568 8.40715 9.43395 10.7501 9.43395C13.0931 9.43395 15.1058 8.61568 16.0003 7.44672C15.9698 7.40606 15.9444 7.3654 15.9139 7.32474Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		opacity="0.3"
		d="M15.9139 7.32474L10.7501 0.25L5.5864 7.32474C5.55591 7.3654 5.53049 7.40606 5.5 7.44672C6.39451 8.61568 8.40715 9.43395 10.7501 9.43395C13.0931 9.43395 15.1058 8.61568 16.0003 7.44672C15.9698 7.40606 15.9444 7.3654 15.9139 7.32474Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M19.5129 21.3319L18.1965 32.3659C18.1965 32.3659 18.1965 32.4065 18.1965 32.4269C18.1965 34.8207 14.8625 36.7571 10.7508 36.7571C6.94912 36.7571 3.81835 35.1002 3.37109 32.9605C4.73318 33.8703 6.73566 34.4446 8.96685 34.4446C13.0785 34.4446 16.4126 32.5031 16.4126 30.1093C16.4126 30.0889 16.4075 30.0686 16.4075 30.0483H16.4126L17.729 19.0194C18.2982 14.2673 17.2004 9.43903 14.4813 5.50015C14.3695 5.33243 14.2526 5.16979 14.1306 5.00715L10.705 0.310989L10.7508 0.25L15.9145 7.32474C16.0365 7.48738 16.1534 7.65002 16.2652 7.81774C18.9792 11.7515 20.0821 16.5849 19.5129 21.3319Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M17.7277 19.0199L16.4114 30.0488H16.4063C16.4063 30.0488 16.4114 30.0895 16.4114 30.1098C16.4114 32.5036 13.0773 34.4451 8.96561 34.4451C6.73442 34.4451 4.73195 33.8708 3.36986 32.9611C3.3292 32.7882 3.30887 32.6104 3.30887 32.4274V32.3664L1.98743 21.3325C1.4182 16.5855 2.52109 11.7521 5.23511 7.81827C5.352 7.65055 5.4689 7.48791 5.58579 7.32528L10.7038 0.311523L14.1294 5.00769C14.2513 5.17033 14.3682 5.33296 14.48 5.50068C17.1991 9.43957 18.2969 14.2679 17.7277 19.0199Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M17.7277 19.0199L16.4114 30.0488H16.4063C16.4063 30.0488 16.4114 30.0895 16.4114 30.1098C16.4114 32.5036 13.0773 34.4451 8.96561 34.4451C6.73442 34.4451 4.73195 33.8708 3.36986 32.9611C3.3292 32.7882 3.30887 32.6104 3.30887 32.4274V32.3664L1.98743 21.3325C1.4182 16.5855 2.52109 11.7521 5.23511 7.81827C5.352 7.65055 5.4689 7.48791 5.58579 7.32528L10.7038 0.311523L14.1294 5.00769C14.2513 5.17033 14.3682 5.33296 14.48 5.50068C17.1991 9.43957 18.2969 14.2679 17.7277 19.0199Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M5.84082 7.11133C7.70438 8.12781 12.7021 8.38194 15.2433 7.11133"
		stroke="#202221"
		stroke-width="0.5"
	/>
	<path
		d="M9.62157 24.2656C9.62157 25.2923 9.2658 26.0242 8.69149 26.3748C8.67624 26.385 8.1375 26.7255 8.11717 26.7357C7.51744 27.0711 7.89863 26.3088 6.98887 25.7853C5.15411 24.7281 3.66496 22.1615 3.66496 20.0523C3.66496 19.0104 2.70438 19.0002 3.29394 18.6546C3.30919 18.6445 3.96483 18.2836 3.98007 18.2785C4.5798 17.9533 5.39807 18.0143 6.29766 18.5327C8.13242 19.5898 9.62157 22.1615 9.62157 24.2656Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M8.96618 24.6584C8.96618 26.7625 7.47703 27.6113 5.64227 26.5541C3.80751 25.4919 2.31836 22.9303 2.31836 20.8211C2.31836 18.7119 3.80751 17.8682 5.64227 18.9254C7.47703 19.9876 8.96618 22.5492 8.96618 24.6584Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M8.3409 24.2961C8.3409 26.0038 7.13128 26.695 5.64213 25.8361C4.15298 24.9772 2.94336 22.8934 2.94336 21.1806C2.94336 19.4678 4.15298 18.7817 5.64213 19.6406C7.13128 20.4996 8.3409 22.5834 8.3409 24.2961Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M6.1707 25.6124C4.68155 24.7535 3.47193 22.6697 3.47193 20.9569C3.47193 20.1691 3.73114 19.5999 4.15298 19.2949C3.42619 19.4271 2.94336 20.0979 2.94336 21.1805C2.94336 22.8882 4.15298 24.9771 5.64213 25.836C6.44515 26.2985 7.16686 26.3138 7.65985 25.958C7.23293 26.0342 6.7196 25.9275 6.1707 25.6124Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M5.23017 35.4461L1.30653 42.958L0.513672 42.4904V39.3088C0.513672 38.8615 0.600073 38.3736 0.762711 37.8756L2.80077 31.6496C3.23785 30.3078 4.18827 29.0677 5.23017 28.4629L5.99253 28.9254L5.23017 35.4512V35.4461Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M6.02314 35.9149L1.30664 42.9591V39.7775C1.30664 39.3303 1.39304 38.8424 1.55568 38.3443L3.59373 32.1183C4.03082 30.7766 4.98124 29.5364 6.02314 28.9316V35.9149Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M16.2643 35.4461L20.188 42.958L20.9808 42.4904V39.3088C20.9808 38.8615 20.8944 38.3736 20.7318 37.8756L18.6937 31.6496C18.2566 30.3078 17.3062 29.0677 16.2643 28.4629L15.502 28.9254L16.2643 35.4512V35.4461Z"
		fill="#202221"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
	<path
		d="M15.4717 35.9149L20.1882 42.9591V39.7775C20.1882 39.3303 20.1018 38.8424 19.9391 38.3443L17.9011 32.1183C17.464 30.7766 16.5136 29.5364 15.4717 28.9316V35.9149Z"
		fill="#D9D9D9"
		stroke="#202221"
		stroke-width="0.5"
		stroke-linejoin="round"
	/>
</svg>
